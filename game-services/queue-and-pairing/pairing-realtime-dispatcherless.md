# 設計簡易的 Dispatcherless 自動配對機制 - 透過 Firebase Realtime Database

遊戲配對系統中，直接規劃分配者（Dispatcher）來配對是最直接的解決辦法，但耗費較高也比較麻煩，以下的設計，透過使用者端發起 Transaction 機制來作動配對邏輯，再另外監聽單場遊戲節點來確認遊戲配對狀態與起始資料，可使用在固定玩家數量的遊戲類型

### 排隊結構

* 透過 **子結點** 實作 **群組配對**，並將玩家屬性寫入排隊資料，配對邏輯可以進行 **屬性配對**

| 根目錄 | 群組 | 資料 |
| --- | --- | --- |
| Queue / | Group ID / | [ <br> Room ID: 已開啟的房間號碼 <br> User: [目前已經報名的玩家，以及其玩家屬性] <br> Create: 房間創立時間 <br> ] |

* 玩家進行自動配對

### 遊戲結構

* 透過 Player 來監聽整體的 **配對狀態**，滿員時即配對完成。Init 則是設計為開場預設資料，統一委由開局者或是關局者來寫入即可

| 根目錄 | - | 資料 |
| --- | --- | --- |
| Game ID / Player / | Player Id / | User <br> Image <br> ... // 遊戲中使用到的玩家基本資料 |
| Game ID / Init / |  | RandomSeed <br> ... // 遊戲中共同設定資料 |

* 監聽配對狀態